
## 1장 소목차 정리

- URL을 입력하면 HTTP 리퀘스트 메세지를 작성한다.
- URL에 매핑된 요청 웹서버 IP를 조회하는 요청을 DNS에 보낸다.
- 전 세계의 DNS가 연대하여 웹 서버의 IP를 찾아낸다.
- <mark style="background: #BBFABBA6;">프로토콜 스택</mark>에 HTTP 리퀘스트 메세지 송신을 의뢰한다.


## HTTP 리퀘스트 메시지를 작성한다.

### 탐험 여행은 URL 입력부터 시작한다.

- 브라우저는 http, ftp. email등 여러 자원에 access할 수 있는 복합적인 클라이언트이다. 
- 따라서 사용자는 브라우저가 어떠한 프로토콜을 사용하여 사용자 요청을 처리해야 할지 지정해줘야 하는데 이러한 이유로 웹서버 액세스라면 http:, ftp 서버 액세스라면 ftp: 이런 방식으로 URL을 작성해줘야 한다.
- URL은 여러가지 형식으로 입력될 수 있으나 공통적인 부분은 맨 앞부분에서 어떤 방식으로 액세스를 하는지 명시한다는 것이다. 여기 명시된 것이 액세스할 때 사용할 프로토콜에 해당한다.
	- 액세스 대상이 웹서버라면 HTTP, ftp 서버라면 FTP 프로토콜을 사용한다.
	- http:, ftp:, file:, mailto: 등의 종류가 있다.

### 브라우저는 먼저 URL을 해독한다

- 브라우저는 HTTP 리퀘스트 메세지를 작성하기 위해서 가장 먼저 입력받은 URL을 해독한다.
- URL의 형식은 다음과 같다. 
```
http://www.cyber.com/dir1/file1.html
```
- 프로토콜 + // + 서버 도메인 명 + / + 접근할 리소스 경로


### 파일명을 생략한 경우

- http://www.cypber.com/
	- 루트 디렉토리 하위의 index.html, default.html 등을 조회
- http://www.cypber.com/dir1/
	-  dir1 디렉토리 하위의 index.html, default.html 등을 조회
- http://www.cypber.com
	- / 구분자가 마지막에 생략되어 있으면 루트 디렉토리 내 기본 파일을 접근하도록 설정하는 것이 관례
	- http://www.cypber.com/index.html, http://www.cypber.com/default.html 
- http://www.cypber.com/whatisthis
	- 통례적으로 위와 같은 경우 / 경로 하위의 whatisthis라는 파일 혹은 디렉토리를 가리킨다고 판단한다.


### HTTP의 기본 개념

- HTTP 프로토콜은 서버와 클라이언트가 주고 받을 메세지의 순서와 형식을 정의한 규칙
- 리퀘스트 메세지는 URI와 HTTP Method를 포함한다. 
	- URI에는 보통 페이저 정보를 담고 있는 파일 이름이나 CGI 프로그램의 파일명을 작성한다.
	- URI에 명시된 자원을 대상으로 어떤 작업을 수행하고 싶은 것인지 명시하는 게 HTTP Method이다. 
- 리퀘스트 메세지가 서버에 도착하면 웹 서버는 메세지를 해독하고 내용대로 요청을 처리한 뒤 그 결과를 응답 메세지에 담아 전송한다. 이 때 처리 결과를 나타내는 스테이터스 코드를 함께 첨부한다.
	- GET, POST, DELETE, PUT, HEAD, OPTIONS, TRACE, CONNECT 등이 존재
	- PUT : URI에 명시된 서버의 파일을 치환한다. 만약 파일이 없으면 새로운 파일을 생성한다. 
	- HEAD : GET과 비슷하나 , 응답 메세지의 헤더에 해당하는 내용만 전송하고 body 데이터는 전송하지 않는다. 파일의 최종 갱신일자 확인과 같은 경우에 사용한다.
	- OPTIONS : 통신 옵션을 통지하거나 조사할 때 사용한다.
	- TRACE : 서버측에서 받은 리퀘스트 Line과 헤더를 그대로 반환한다. 여러 프록시 서버를 거치며 요청 메세지의 헤더가 어떻게 변화하는지 확인하기 위해 사용한다.
	- CONNECT : 암호화한 메세지를 프록시로 전송할 때 이용하는 메서드이다.
	- HTTP 1.0에서는 GET, POST, HEAD만 정식으로 사용한다고 정의되어 있으며 PUT, DELETE는 부록에 부가기능으로 기술되어 있다.
	- HTTP1.1에서는 전부 사용이다.

### HTTP 리퀘스트 메세지를 만든다.

- 리퀘스트 메세지 형식

```
GET /api/study/1 HTTP/1.1  => 리퀘스트 라인(HTTP메서드 URI HTTP버전)
Accept: */*
Connection: Keep-Alive
...
(공백)
...
메세지 바디
...
```


### 리퀘스트 메세지를 보내면 응답이 되돌아온다

- 리스폰스 메세지 형식

```
HTTP/1.1 200 OK  => 스테이터스 라인 (HTTP버전 응답코드 응답메세지)
DATE : ...
...
(공백)
...
메세지 바디
...
```


- 리스폰스 응답 코드

| 코드값 | 설명                                    |
|:------ |:--------------------------------------- |
| 1xx    | 요청 처리의 경과 상황 등을 전달         |
| 2xx    | 요청 정상 처리 후 종료                  |
| 3xx    | 추가적인 요청과 같은 다른 조치가 필요함 |
| 4xx    | 클라이언트 측 오류                      |
| 5xx    | 서버 측 오류                            |


만약 응답으로 받은 html 파일 등에 이미지나 영상 등이 포함될 수 있는데 이러한 정보는 태그로 표시되어 있다. 맨 처음 html 파일 등을 응답받고 추가적인 태그를 확인했다면 해당 태그에 명시된 이미지나 영상을 추가로 요청하는 리퀘스트 메세지를 보낸다. 

ex) 이미지 태그가 3개인 html 파일을 요청하는 경우 총 요청과 응답은 몇 번 이뤄질까?
=> html 1번 각 이미지 1번씩 도합 3번 총합 4번의 요청과 응답이 발생하게 된다.



---


## 웹 서버의 IP주소를 DNS 서버에 조회한다

- IP 주소의 기본

웹 서버는 웹 요청 메세지를 만들기만 할 뿐 이를 직접 전송하는 기능은 수행하지 않기 때문에 실제로 웹 요청 메세지를 전송하는 것은 OS에서 담당한다.

